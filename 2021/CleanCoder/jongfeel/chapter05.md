# 5장 테스트 주도 개발

켄트 벡과의 일화는 사실 TDD를 처음 겪는 사람이라면 이해할 수 없는 놀라운 장면이기도 하다.

아니 테스트 코드를 먼저 짜고 실제 코드를 짠 후에 돌려보는 시간이 30초라고?

그때도 가능했지만, 지금도 가능하다.

잘 이해가 안되고 있는건 아마 TDD를 해보지 않았기 떄문일지도 모른다.

## 배심원 등장

TDD는 외과의사가 손을 씻어야 하듯 프로그래머도 TDD를 꼭 적용해야 한다고 한다.

TDD는 어려울 수 있다. 하지만 내가 짠 코드를 검증한다는 의미에서 테스트 코드는 필요하다고 생각한다.

## TDD의 세 가지 법칙

책의 내용을 일단 적어본다.

1. 실패한 단위 테스트를 만들기 전에는 제품 코드를 만들지 않는다.
2. 컴파일이 안 되거나 실패한 단위 테스트가 있으면 더 이상의 단위 테스트를 만들지 않는다.
3. 실패한 단위 테스트를 통과하는 이상의 제품 코드는 만들지 않는다.

잘 이해가 안될 수 있지만, 나는 TDD를 실천하고 그 의미가 뭔지 조금은 알고 있기 때문에 얘기하자면 3번이 제일 핵심적인 내용이라고 본다.

1번은 TDD의 당연한 얘기이고, 2번 역시 TDD를 하는 방법 중의 하나이기에 실천의 영역이다.

하지만 3번의 의미는 중요한 걸 표현하고 있는데, 이는 설계를 얼마나 잘 했는가를 뒷받침하기 떄문이다. 왜냐하면 설계가 이루어진 만큼 테스트 코드를 작성했을 테고 그 테스트를 통과하는 제품 코드가 나온다면 깔끔하게 진행되는건 어찌 보면 당연한 얘기인데, 여기서 설계가 없거나 형편없는 설계를 했다면 쓸데 없는 제품 코드를 더 짤 가능성이 높아지기 떄문에 3번의 의미가 있다고 생각한다.

### 수 많은 혜택

#### 확신

확신을 주는 건 당연하다. 거의 모든 제품 코드에 테스트 코드를 작성했고 그 테스트 코드가 통과됐다면 확신이 생기는 건 당연하다.

#### 결함 주입 비율

TDD를 하면 따라오는 자연스러운 혜택 정도라고 보여진다. 추가로 작성된 코드가 새로운 결함을 만드는 비율 => 결함 주입 비율이 매우 낮다는게 보고서와 연구에서 나왔다고 하니까.

#### 용기

이건 정성적인 부분에 대한 평가인데, 실제 해보면 사람마다 다를 수는 있다. TDD를 하는 과정에서는 용기가 생긴다는 건 의심해 볼만 한데, 이게 누적되고 양이 많아지면 잘못된 코드를 수정하는데 두렵지 않고 점점 자신감이 생긴다는 건 맞는 얘기다. 

#### 문서화

문서화 부분은 특히 공감을 하는게, 실제 제품 코드의 동작 방법과 같은 매뉴얼의 역할을 충실히 하기 때문이다.

그리고 책에 언급된 두 문장이 정확한 팩트를 얘기해 준다.

> 단위 테스트는 문서다. 시스템의 가장 낮은 단계의 설계를 알려준다.

역시 설계를 언급하지 않을 수가 없다!

#### 설계

마지막 기승전설계로 아름답게 마무리 짓는다. 역시 책에 나온 걸 인용해 본다.

> 다른 말로 표현하면 테스트르 먼저 만들기 위해서는 좋은 설계를 고민해야 한다.

이쯤 되면 설계의 중요성에 대해서는 언급을 계속 해도 될 정도라고 본다. 나 역시 TDD의 기본은 좋은 설계라고 생각하기 때문이다.

그리고 TDD가 아닌 사후 테스트, 즉 코드를 작성한 후에 나중에 테스트를 작성하는 건 옳지 않다고 한다. 뭐 이건 TDD 관점에서야 그런 것이고, 실제 나중에 테스트 코드를 잘 작성할 수 있다면 괜찮다고 보는 입장이다.

나중에라도 테스트 코드를 짜면 다행인데, 내 경험상 테스트 코드를 짜는 사람을 거의 본적이 없다는 게 문제라면 문제일 것이다.

### 프로다운 선택

그럼 이제 TDD를 해봐야 겠지?

## TDD와 관련 없는 사실

TDD에 대해 현실적인 부분에 대한 조언도 준다.

좋은 점 보다 해로운 점이 많을 때는 규칙을 따라서는 안된다라고 하는데, 나는 그게 일정 탓으로 돌리는건 아니라고 보고 싶다.